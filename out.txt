BEGIN;
--
-- Create model Concept
--
CREATE TABLE `meas_models_concept` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `name` varchar(200) NOT NULL UNIQUE, `description` longtext NOT NULL);
--
-- Create model EducationLevel
--
CREATE TABLE `meas_models_educationlevel` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `name` varchar(200) NOT NULL UNIQUE, `description` longtext NOT NULL);
--
-- Create model KeyPoint
--
CREATE TABLE `meas_models_keypoint` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `name` varchar(200) NOT NULL, `content` longtext NOT NULL, `concept_id` integer NOT NULL);
--
-- Create model Paper
--
CREATE TABLE `meas_models_paper` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `year` integer NOT NULL, `month` varchar(20) NOT NULL, `number` integer NOT NULL, `no_of_question` integer NULL);
--
-- Create model Question
--
CREATE TABLE `meas_models_question` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `question_type` varchar(2) NOT NULL, `source` varchar(2) NOT NULL, `used_for` varchar(2) NOT NULL, `mark` integer NOT NULL, `difficulty_level` varchar(1) NOT NULL, `respone_type` varchar(10) NOT NULL, `content` longtext NOT NULL, `solution` longtext NOT NULL, `concept_id` integer NOT NULL, `keypoint_id` integer NULL, `paper_id` integer NULL, `answer` longtext NOT NULL);
--
-- Create model Subject
--
CREATE TABLE `meas_models_subject` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `name` varchar(200) NOT NULL UNIQUE, `description` longtext NOT NULL, `education_level_id` integer NOT NULL);
--
-- Create model Test
--
CREATE TABLE `meas_models_test` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `name` varchar(200) NOT NULL, `test_type` varchar(200) NOT NULL, `questions_list` longtext NOT NULL, `number_of_questions` integer NOT NULL);
--
-- Create model Topic
--
CREATE TABLE `meas_models_topic` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `name` varchar(200) NOT NULL UNIQUE, `description` longtext NOT NULL, `order` integer UNSIGNED NULL, `subject_id` integer NOT NULL);
--
-- Add field topic to concept
--
ALTER TABLE `meas_models_concept` ADD COLUMN `topic_id` integer NOT NULL;
ALTER TABLE `meas_models_concept` ALTER COLUMN `topic_id` DROP DEFAULT;
--
-- Create model AnswerPart
--
CREATE TABLE `meas_models_answerpart` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `part_name` varchar(1) NOT NULL, `part_content` longtext NOT NULL, `part_respone_type` varchar(10) NOT NULL, `question_id` integer NOT NULL, `respone_type_1` varchar(10) NULL, `respone_type_2` varchar(10) NULL, `respone_type_3` varchar(10) NULL, `respone_type_4` varchar(10) NULL, `subpart_content_1` longtext NULL, `subpart_content_2` longtext NULL, `subpart_content_3` longtext NULL, `subpart_content_4` longtext NULL, `subpart_name_1` varchar(10) NULL, `subpart_name_2` varchar(10) NULL, `subpart_name_3` varchar(10) NULL, `subpart_name_4` varchar(10) NULL);
--
-- Add field subject to paper
--
ALTER TABLE `meas_models_paper` ADD COLUMN `subject_id` integer DEFAULT 1 NOT NULL;
ALTER TABLE `meas_models_paper` ALTER COLUMN `subject_id` DROP DEFAULT;
--
-- Add field order to concept
--
ALTER TABLE `meas_models_concept` ADD COLUMN `order` integer UNSIGNED DEFAULT 1 NULL;
ALTER TABLE `meas_models_concept` ALTER COLUMN `order` DROP DEFAULT;
--
-- Create model Formula
--
CREATE TABLE `meas_models_formula` (`id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY, `content` longtext NOT NULL, `constant_term` varchar(1024) NULL, `inorder_term` varchar(1024) NULL, `sorted_term` varchar(1024) NULL, `status` bool NOT NULL, `structure_term` varchar(1024) NULL, `variable_term` varchar(1024) NULL);
--
-- Remove field source from question
--
ALTER TABLE `meas_models_question` DROP COLUMN `source` CASCADE;
--
-- Create model FormulaIndex
--
CREATE TABLE `meas_models_formulaindex` (`indexkey` varchar(255) NOT NULL PRIMARY KEY, `docsids` longtext NULL, `df` integer UNSIGNED NOT NULL);
--
-- Add field question to formula
--
ALTER TABLE `meas_models_formula` ADD COLUMN `question_id` integer NULL;
ALTER TABLE `meas_models_formula` ALTER COLUMN `question_id` DROP DEFAULT;
ALTER TABLE `meas_models_keypoint` ADD CONSTRAINT `meas_models_keypoi_concept_id_c65b7b8f_fk_meas_models_concept_id` FOREIGN KEY (`concept_id`) REFERENCES `meas_models_concept` (`id`);
ALTER TABLE `meas_models_question` ADD CONSTRAINT `meas_models_questi_concept_id_2821a4c0_fk_meas_models_concept_id` FOREIGN KEY (`concept_id`) REFERENCES `meas_models_concept` (`id`);
ALTER TABLE `meas_models_question` ADD CONSTRAINT `meas_models_ques_keypoint_id_bb366db4_fk_meas_models_keypoint_id` FOREIGN KEY (`keypoint_id`) REFERENCES `meas_models_keypoint` (`id`);
ALTER TABLE `meas_models_question` ADD CONSTRAINT `meas_models_question_paper_id_86003a5f_fk_meas_models_paper_id` FOREIGN KEY (`paper_id`) REFERENCES `meas_models_paper` (`id`);
ALTER TABLE `meas_models_subject` ADD CONSTRAINT `mea_education_level_id_f2b87063_fk_meas_models_educationlevel_id` FOREIGN KEY (`education_level_id`) REFERENCES `meas_models_educationlevel` (`id`);
ALTER TABLE `meas_models_topic` ADD CONSTRAINT `meas_models_topic_subject_id_584b18ec_fk_meas_models_subject_id` FOREIGN KEY (`subject_id`) REFERENCES `meas_models_subject` (`id`);
CREATE INDEX `meas_models_concept_19b4d727` ON `meas_models_concept` (`topic_id`);
ALTER TABLE `meas_models_concept` ADD CONSTRAINT `meas_models_concept_topic_id_eac03a60_fk_meas_models_topic_id` FOREIGN KEY (`topic_id`) REFERENCES `meas_models_topic` (`id`);
ALTER TABLE `meas_models_answerpart` ADD CONSTRAINT `meas_models_answ_question_id_ca7898a1_fk_meas_models_question_id` FOREIGN KEY (`question_id`) REFERENCES `meas_models_question` (`id`);
CREATE INDEX `meas_models_paper_ffaba1d1` ON `meas_models_paper` (`subject_id`);
ALTER TABLE `meas_models_paper` ADD CONSTRAINT `meas_models_paper_subject_id_e2f65402_fk_meas_models_subject_id` FOREIGN KEY (`subject_id`) REFERENCES `meas_models_subject` (`id`);
CREATE INDEX `meas_models_formula_7aa0f6ee` ON `meas_models_formula` (`question_id`);
ALTER TABLE `meas_models_formula` ADD CONSTRAINT `meas_models_form_question_id_754da866_fk_meas_models_question_id` FOREIGN KEY (`question_id`) REFERENCES `meas_models_question` (`id`);
COMMIT;
